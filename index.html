<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BICI CHECK MAX</title>
    <style>
        :root { --p: #2563eb; --warn: #f59e0b; --danger: #ef4444; --safe: #22c55e; }
        body { font-family: ui-sans-serif, system-ui, sans-serif; background: #000; margin: 0; padding: 0; color: #fff; }
        
        /* Cabecera compacta */
        .header { background: #111; padding: 10px; text-align: center; border-bottom: 1px solid #333; }
        .header h2 { margin: 0; font-size: 1.2rem; letter-spacing: 2px; color: var(--p); }

        /* Contenedor sin espacios entre tarjetas */
        #forecast-list { display: flex; flex-direction: column; }

        /* Tarjetas gigantes y pegadas */
        .hour-card { 
            display: flex; 
            align-items: center; 
            padding: 20px 10px; 
            border-bottom: 2px solid #222; 
            border-left: 15px solid #444;
            background: #000;
        }
        
        /* Hora en gigante */
        .hour-time { 
            font-size: 2.2rem; 
            font-weight: 900; 
            min-width: 90px; 
            color: #fff;
            line-height: 1;
        }
        
        .main-info { flex-grow: 1; padding: 0 10px; }
        
        /* Temperatura en gigante */
        .temp { font-size: 2.5rem; font-weight: 900; line-height: 1; }
        .feel { font-size: 1rem; color: #aaa; display: block; margin-top: 5px; }
        
        /* Datos de la derecha más grandes */
        .stats { text-align: right; min-width: 100px; }
        .val { font-size: 1.6rem; font-weight: 800; display: block; line-height: 1.1; }
        .label { font-size: 0.75rem; font-weight: bold; color: #777; text-transform: uppercase; }

        .wind { color: #3b82f6; }
        .rain { color: #22d3ee; }

        /* Alertas de color intensas */
        .risk-high { border-left-color: var(--danger); background: #1a0505; }
        .risk-med { border-left-color: var(--warn); background: #1a1205; }
        .risk-low { border-left-color: var(--safe); }

        #loader { text-align: center; padding: 50px; font-size: 1.5rem; color: var(--p); }
    </style>
</head>
<body onload="checkBici()">

<div class="header">
    <h2>BICI PREVISIÓN</h2>
</div>

<div id="loader">CARGANDO...</div>
<div id="forecast-list"></div>

<script>
const LAT = 40.33669864725108;
const LON = -3.8369067073823744;

async function checkBici() {
    try {
        const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${LAT}&longitude=${LON}&hourly=temperature_2m,apparent_temperature,precipitation_probability,wind_gusts_10m&timezone=auto&forecast_days=1`);
        const data = await response.json();
        
        const currentHour = new Date().getHours();
        const list = document.getElementById('forecast-list');
        list.innerHTML = '';
        
        for (let i = currentHour; i < currentHour + 6; i++) {
            const h = data.hourly;
            if (!h.time[i]) break;

            const time = h.time[i].split('T')[1];
            const temp = Math.round(h.temperature_2m[i]);
            const feel = Math.round(h.apparent_temperature[i]);
            const rain = h.precipitation_probability[i];
            const gusts = Math.round(h.wind_gusts_10m[i]);
            
            let riskClass = 'risk-low';
            if (gusts > 35 || rain > 40) riskClass = 'risk-high';
            else if (gusts > 22 || rain > 15) riskClass = 'risk-med';

            list.innerHTML += `
                <div class="hour-card ${riskClass}">
                    <div class="hour-time">${time}</div>
                    <div class="main-info">
                        <div class="temp">${temp}°</div>
                        <span class="feel">Siente ${feel}°</span>
                    </div>
                    <div class="stats">
                        <span class="label">Racha</span>
                        <span class="val wind">${gusts}<small style="font-size:0.8rem">km/h</small></span>
                        <span class="label" style="margin-top:8px">Lluvia</span>
                        <span class="val rain">${rain}%</span>
                    </div>
                </div>
            `;
        }
        document.getElementById('loader').style.display = 'none';
    } catch (err) {
        document.getElementById('loader').innerText = "ERROR DE CONEXIÓN";
    }
}
</script>

</body>
</html>